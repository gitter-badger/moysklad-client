/**
 * clone
 * Date: 15.06.14
 * Vitaliy V. Makeev (w.makeev@gmail.com)
 */

var _ = require('lodash');

var fieldsToDelete = [
    'createdBy',
    'updated',
    'updatedBy',
    'uuid',
    'operationUuid'
];

var resetUuid = function (value) {
    //console.log(arguments);
    if (typeof value === 'object') {
        if (_.some(fieldsToDelete, function (fieldName) {
                return fieldName in value
            })) return _.cloneDeep(_.omit(value, fieldsToDelete), resetUuid);
    }
};

/**
 * Клонирует объекты МойСклад
 * используется стандартная процедура глубокого клонирования,
 * дополнительно к этому обнуляются поля: uuid, createdBy, updated, updatedBy, operationUuid
 *
 * @param obj Клонируемый объект
 */
var clone = function (obj) {

    if (obj) {
        return _.cloneDeep(obj, resetUuid);
    }

    return null;
};

module.exports = clone;