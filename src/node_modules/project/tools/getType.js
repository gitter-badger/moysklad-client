/**
 * getType
 * Date: 14.06.14
 * Vitaliy V. Makeev (w.makeev@gmail.com)
 */

var _ = require('lodash')
  , defaultMap = require('project/mapping');

var typeInfosScopeMap = {};

var getType = function(typeName, map) {
    map = map || defaultMap[0];
    var typeInfos = map.typeInfos;

    if (!typeInfosScopeMap[typeName]) {
        var type = _.find(typeInfos, { localName: typeName });
        if (type) {
            typeInfosScopeMap[typeName] = type;
            if (type.baseTypeInfo)
                type.baseTypeInfo = getType(type.baseTypeInfo.split('.')[1], map);
        }
    }
    return typeInfosScopeMap[typeName];
};

module.exports = getType;