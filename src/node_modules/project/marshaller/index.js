/**
 * index
 * Date: 12.08.14
 * Vitaliy V. Makeev (w.makeev@gmail.com)
 */

var jsonix = require('project/jsonix'),
    stampit = require('stampit');

var marshaller = stampit()
    .enclose(function () {
        var opt = {
            discardTimezone: !(this.options && this.options.serverTimezone)
        };

        var context = jsonix.createContext(
            this.getProvider('mapping'), opt);

        var marshaller   = context.createMarshaller()       // JSON --> XML
          , unmarshaller = context.createUnmarshaller();    // XML --> JSON

        this.marshalString      = marshaller.marshalString.bind(marshaller);
        this.unmarshalDocument  = unmarshaller.unmarshalDocument.bind(unmarshaller);
        this.unmarshalString    = unmarshaller.unmarshalString.bind(unmarshaller);
    });

module.exports = marshaller;