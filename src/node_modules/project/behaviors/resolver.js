var _ = require('lodash')
var have = require('project/have')

var globalStore = {}

/**
 * Интерфейс для контейнера зависимостей с глобальным хранилищем
 * в рамках приложения
 *
 * @return {undefined}
 */
function resolverBehavior () {
  /**
   * Возвращает зависимость по имени
   * @param {string} name Название зависимости
   * @return {*} Зависимость
   */
  this.resolve = function resolve (name) {
    if (globalStore[name]) {
      return globalStore[name]
    } else {
      throw new Error('Resolver: can\'t resolve "' + name + '"')
    }
  }

  /**
   * Добавляет зависимость в глобальный репозиторий
   * @return {this} this
   */
  this.addDependency = function addDependency () {
    var args = have(arguments, [
      { name: 'string', dependency: 'string' },
      { dependencies: 'object' }
    ])
    if (args.name) {
      globalStore[args.name] = args.dependency
    } else {
      _.assign(globalStore, args.dependencies)
    }
    return this
  }
}

module.exports = resolverBehavior
