var defaultAuth = require('project/default-auth')

function AuthStore (login, password) {
  this.auth = {
    login: login,
    password: password
  }

  if (!this.haveAuth()) {
    this.auth = defaultAuth.getAuth()
  }
}

AuthStore.prototype.haveAuth = function haveAuth () {
  return this.auth.login && this.auth.password
}

AuthStore.prototype.setAuth = function setAuth (login, password) {
  if (!login) {
    throw new Error('Login must be specified')
  }
  if (!password) {
    throw new Error('Password must be specified')
  }
  this.auth.login = login
  this.auth.password = password
}

AuthStore.prototype.getAuth = function getAuth () {
  if (!this.haveAuth()) {
    throw new Error('Login and password or default credentials not specified.')
  }
  return this.auth
}

module.exports = AuthStore
